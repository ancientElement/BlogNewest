---
title: 进程与线程
categories:
  - 随手记
date: 2024-03-16 23:00
tags:
  - 随手记
  - 所想
series:
  - 随手记
---
## 线程和进程的区别 

[线程和进程的区别 • Worktile社区](https://worktile.com/kb/p/36374)
[一文读懂什么是进程、线程、协程 - 回首笑人间 - 博客园 (cnblogs.com)](https://www.cnblogs.com/Survivalist/p/11527949.html#%E8%BF%9B%E7%A8%8B)

## 什么是程序

程序是一个静态的代码集合，一个exe执行文件等等。

一个程序可以打开多个进程。
### 什么是进程？

进程（Process）是动态的，可以由一个程序打开多个进程。

不同的进程PID是不同的，操作系统通过PID区分进程。
### 线程

在早期的操作系统中并没有线程的概念，进程是能拥有资源和独立运行的最小单位，也是程序执行的最小单位。任务调度采用的是时间片轮转的抢占式调度方式，而进程是任务调度的最小单位，每个进程有各自独立的一块内存，使得各个进程之间内存地址相互隔离。

后来，随着计算机的发展，对CPU的要求越来越高，**进程之间的切换开销较大**，已经无法满足越来越复杂的程序的要求了。于是就发明了线程。

线程是**程序执行**中一个**单一的顺序控制流程**，是**程序执行流**的**最小单元**，是处理器调度和分派的基本单位。一个进程可以有一个或**多个线程**，各个线程之间共享程序的内存空间(也就是所在进程的内存空间)。一个标准的线程由**线程ID**、当前**指令指针(PC)**、**寄存器**和**堆栈**组成。而进程由内存空间(代码、数据、进程空间、打开的文件)和一个或多个线程组成。  

（读到这里可能有的读者迷糊，感觉这和Java的内存空间模型不太一样，但如果你深入的读过深入理解Java虚拟机这本书的话你就会恍然大悟）
### 1、根本区别

进程是操作系统进行资源分配的最小单元，线程是操作系统进行运算调度的最小单元。进程（Process）是计算机中的程序关于某数据集合上的一次运行活动，是系统进行资源分配和调度的基本单位，是操作系统结构的基础。线程是操作系统能够进行运算调度的最小单位。它被包含在进程之中，是进程中的实际运作单位。

### 2、从属关系不同

进程中包含了线程，线程属于进程。一个进程可以有很多线程，每条线程并行执行不同的任务。一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。

### 3、开销不同

进程的创建、销毁和切换的开销都远大于线程。由于线程比进程更小，基本上不拥有系统资源，故对它的调度所付出的开销就会小得多，能更高效的提高系统内多个程序间并发执行的程度，从而显著提高系统资源的利用率和吞吐量。

### 4、拥有资源不同

每个进程有自己的内存和资源，一个进程中的线程会共享这些内存和资源。进程是资源分配的基本单位。所有与该进程有关的资源，都被记录在进程控制块PCB中。以表示该进程拥有这些资源或正在使用它们。另外，进程也是抢占处理机的调度单位，它拥有一个完整的虚拟地址空间。当进程发生调度时，不同的进程拥有不同的虚拟地址空间，而同一进程内的不同线程共享同一地址空间。

### 5、控制和影响能力不同

子进程无法影响父进程，而子线程可以影响父线程，如果主线程发生异常会影响其所在进程和子线程。与进程相对应，线程与资源分配无关，它属于某一个进程，并与进程内的其他线程一起共享进程的资源。

### 6、CPU利用率不同

进程的CPU利用率较低，因为上下文切换开销较大，而线程的CPU的利用率较高，上下文的切换速度快。在多核或多CPU，或支持Hyper-threading的CPU上使用多线程程序设计的好处是显而易见，即提高了程序的执行吞吐率。在单CPU单核的计算机上，使用多线程技术，也可以把进程中负责I/O处理、人机交互而常被阻塞的部分与密集计算的部分分开来执行，编写专门的workhorse线程执行密集计算，从而提高了程序的执行效率。

## 进程间、线程间的通讯方式

[进程间通信和线程间通信的几种方式 - 反光的小鱼儿 - 博客园 (cnblogs.com)](https://www.cnblogs.com/fanguangdexiaoyuer/p/10834737.html#_label3)
### 进程通信

#### 管道(pipe)

管道是一种半双工的通信方式，数据只能单向流动，而且只能在具有亲缘关系的进程间使用。进程的亲缘关系通常是指父子进程关系。

#### 有名管道 (namedpipe)

有名管道也是半双工的通信方式，但是它允许无亲缘关系进程间的通信。

#### 信号量(semaphore)

信号量是一个计数器，可以用来控制多个进程对共享资源的访问。它常作为一种锁机制，防止某进程正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同一进程内不同线程之间的同步手段。

#### 消息队列(messagequeue)

消息队列是由消息的链表，存放在内核中并由消息队列标识符标识。消息队列克服了信号传递信息少、管道只能承载无格式字节流以及缓冲区大小受限等缺点。

#### 信号 (sinal)

信号是一种比较复杂的通信方式，用于通知接收进程某个事件已经发生。

#### 共享内存(shared memory)

共享内存就是映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问。共享内存是最快的 IPC 方式，它是针对其他进程间通信方式运行效率低而专门设计的。它往往与其他通信机制，如信号量，配合使用，来实现进程间的同步和通信。

#### 套接字(socket)

套接口也是一种进程间通信机制，与其他通信机制不同的是，它可用于不同设备及其间的进程通信。、

### 线程间的通信方式

#### 锁机制：包括互斥锁、条件变量、读写锁

互斥锁提供了以排他方式防止数据结构被并发修改的方法。   
读写锁允许多个线程同时读共享数据，而对写操作是互斥的。   
条件变量可以以原子的方式阻塞进程，直到某个特定条件为真为止。对条件的测试是在互斥锁的保护下进行的。条件变量始终与互斥锁一起使用。

wait/notify 等待

Volatile 内存共享

CountDownLatch 并发工具

CyclicBarrier 并发工具

#### 信号量机制(Semaphore)

包括无名线程信号量和命名线程信号量。

#### 信号机制(Signal)

类似进程间的信号处理。

线程间的通信目的主要是用于线程同步，所以线程没有像进程通信中的用于数据交换的通信机制。
